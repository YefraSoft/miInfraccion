"use strict";(self["webpackChunkinfraccion"]=self["webpackChunkinfraccion"]||[]).push([[594],{5347:function(a,e,i){i.r(e),i.d(e,{default:function(){return d}});var t=function(){var a=this,e=a._self._c;return e("div",{staticClass:"dashboard"},[e("div",{staticClass:"sidebar"},[e("h2",{staticClass:"fade-in-left"},[a._v("Opciones del Agente")]),e("ul",[e("li",{staticClass:"fade-in-left",on:{click:function(e){return a.showSection("registerInfraccion")}}},[a._v("Registrar Infracción")]),e("li",{staticClass:"fade-in-left",on:{click:function(e){return a.showSection("misInfracciones")}}},[a._v("Mis Infracciones")]),e("li",{staticClass:"fade-in-left",on:{click:function(e){return a.showSection("reportes")}}},[a._v("Reportes")]),a._v(" "),e("li",{staticClass:"fade-in-left",on:{click:a.logout}},[a._v("Cerrar Sesión")])])]),e("div",{staticClass:"content"},[e("div",{staticClass:"header"},[e("h1",{staticClass:"animated-title"},[a._v("Bienvenido, Agente "+a._s(a.agentName))]),e("p",{staticClass:"subtitle"},[a._v("Aquí puedes gestionar infracciones y consultar tus registros.")]),e("div",{staticClass:"divider"})]),"reportes"===a.activeSection?e("div",{staticClass:"fade-in"},[e("h2",[a._v("Reportes")]),a._l(a.reportes,(function(i){return e("div",{key:i.id,staticClass:"reporte-card"},[e("div",{staticClass:"reporte-header"},[e("strong",[a._v("ID:")]),a._v(" "+a._s(i.id)+" ")]),e("div",{staticClass:"reporte-details"},[e("p",[e("strong",[a._v("Descripción:")]),a._v(" "+a._s(i.descripcion))]),e("p",[e("strong",[a._v("Estado:")]),a._v(" "+a._s(i.estado))]),e("p",[e("strong",[a._v("Calle:")]),a._v(" "+a._s(i.calle))]),e("p",[e("strong",[a._v("Código Postal:")]),a._v(" "+a._s(i.codigo_postal))])]),e("div",{staticClass:"reporte-actions"},["Atendido"!==i.estado?e("button",{staticClass:"btn-verde",on:{click:function(e){return a.cambiarEstado(i.id,"Atendido")}}},[a._v(" Marcar como Atendido ")]):a._e(),"Pendiente"!==i.estado?e("button",{staticClass:"btn-rojo",on:{click:function(e){return a.cambiarEstado(i.id,"Pendiente")}}},[a._v(" Marcar como Pendiente ")]):a._e()])])})),0===a.reportes.length?e("p",[a._v("No hay reportes disponibles.")]):a._e()],2):a._e(),"registerInfraccion"===a.activeSection?e("div",{staticClass:"fade-in"},[e("h2",[a._v("Registrar una Infracción")]),e("form",{staticClass:"infraccion-form",on:{submit:function(e){return e.preventDefault(),a.registrarInfraccion.apply(null,arguments)}}},[e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"placas"}},[a._v("Placas del Vehículo:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.infraccion.placas,expression:"infraccion.placas"}],attrs:{type:"text",id:"placas",required:""},domProps:{value:a.infraccion.placas},on:{input:function(e){e.target.composing||a.$set(a.infraccion,"placas",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"estado"}},[a._v("Estado:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:a.infraccion.estado,expression:"infraccion.estado"}],attrs:{id:"estado",required:""},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(a){return a.selected})).map((function(a){var e="_value"in a?a._value:a.value;return e}));a.$set(a.infraccion,"estado",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:"",disabled:""}},[a._v("Selecciona un estado")]),e("option",{attrs:{value:"Ciudad de México"}},[a._v("Ciudad de México")]),e("option",{attrs:{value:"Jalisco"}},[a._v("Jalisco")]),e("option",{attrs:{value:"Nuevo León"}},[a._v("Nuevo León")])])])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"marca"}},[a._v("Marca:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:a.infraccion.marca,expression:"infraccion.marca"}],attrs:{id:"marca",required:""},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(a){return a.selected})).map((function(a){var e="_value"in a?a._value:a.value;return e}));a.$set(a.infraccion,"marca",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:"",disabled:""}},[a._v("Selecciona una marca")]),e("option",{attrs:{value:"Toyota"}},[a._v("Toyota")]),e("option",{attrs:{value:"Ford"}},[a._v("Ford")]),e("option",{attrs:{value:"Nissan"}},[a._v("Nissan")])])]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"color"}},[a._v("Color del Vehículo:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.infraccion.color,expression:"infraccion.color"}],attrs:{type:"text",id:"color",required:""},domProps:{value:a.infraccion.color},on:{input:function(e){e.target.composing||a.$set(a.infraccion,"color",e.target.value)}}})])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"lugar"}},[a._v("Lugar de la Infracción:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.infraccion.lugar,expression:"infraccion.lugar"}],attrs:{type:"text",id:"lugar",required:""},domProps:{value:a.infraccion.lugar},on:{input:function(e){e.target.composing||a.$set(a.infraccion,"lugar",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"fecha"}},[a._v("Fecha de la Infracción:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.infraccion.fecha,expression:"infraccion.fecha"}],attrs:{type:"date",id:"fecha",required:""},domProps:{value:a.infraccion.fecha},on:{input:function(e){e.target.composing||a.$set(a.infraccion,"fecha",e.target.value)}}})])]),e("div",{staticClass:"form-row"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"hora"}},[a._v("Hora de la Infracción:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.infraccion.hora,expression:"infraccion.hora"}],attrs:{type:"time",id:"hora",required:""},domProps:{value:a.infraccion.hora},on:{input:function(e){e.target.composing||a.$set(a.infraccion,"hora",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"descripcion"}},[a._v("Descripción de la infracción:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.infraccion.descripcion,expression:"infraccion.descripcion"}],attrs:{type:"text",id:"descripcion",required:""},domProps:{value:a.infraccion.descripcion},on:{input:function(e){e.target.composing||a.$set(a.infraccion,"descripcion",e.target.value)}}})])]),a._m(0)])]):a._e(),"misInfracciones"===a.activeSection?e("div",{staticClass:"fade-in"},[e("h2",[a._v("Mis Infracciones Registradas")]),a.infracciones.length>0?e("ul",{staticClass:"infracciones-list"},a._l(a.infracciones,(function(i){return e("li",{key:i.id,staticClass:"infraccion-item"},[e("div",{staticClass:"infraccion-header"},[e("strong",[a._v("Infracción ID:")]),a._v(" "+a._s(i.id)+" ")]),e("div",{staticClass:"infraccion-details"},[e("p",[e("strong",[a._v("Placas:")]),a._v(" "+a._s(i.placas||"No disponible"))]),e("p",[e("strong",[a._v("Marca:")]),a._v(" "+a._s(i.marca||"No disponible"))]),e("p",[e("strong",[a._v("Color:")]),a._v(" "+a._s(i.color||"No disponible"))]),e("p",[e("strong",[a._v("Estado:")]),a._v(" "+a._s(i.estado||"No disponible"))]),e("p",[e("strong",[a._v("Lugar:")]),a._v(" "+a._s(i.lugar||"No disponible"))]),e("p",[e("strong",[a._v("Fecha:")]),a._v(" "+a._s(i.fecha?a.formatFecha(i.fecha):"No disponible"))]),e("p",[e("strong",[a._v("Descripción:")]),a._v(" "+a._s(i.descripcion||"No disponible"))])]),e("button",{staticClass:"notify-button",on:{click:function(e){return a.notificarCiudadano(i)}}},[a._v("Notificar")]),e("button",{staticClass:"delete-button",on:{click:function(e){return a.eliminarInfraccion(i.id)}}},[a._v("Eliminar esta infracción")])])})),0):e("p",[a._v("No has registrado infracciones aún.")])]):a._e()]),e("footer",{staticClass:"footer"},[e("p",[a._v("© "+a._s(a.currentYear)+" - Derechos reservados")])])])},r=[function(){var a=this,e=a._self._c;return e("div",{staticClass:"form-row"},[e("button",{staticClass:"cta-button",attrs:{type:"submit"}},[a._v("Registrar Infracción")])])}],n=(i(4114),i(4373)),o={name:"AboutView",data(){return{agentName:"Agente",activeSection:"registerInfraccion",infraccion:{placas:"",estado:"",marca:"",color:"",lugar:"",fecha:"",hora:"",descripcion:"",ciudadano_id:null,vehiculo_id:null},reportes:[],infracciones:[],currentYear:(new Date).getFullYear(),agenteId:null}},mounted(){const a=JSON.parse(localStorage.getItem("agente"));a&&a.numero_agente?(this.agentName=a.numero_agente,this.agenteId=a.id,this.fetchInfracciones()):this.$router.push("/login")},methods:{showSection(a){this.activeSection=a,"misInfracciones"===a?this.fetchInfracciones():"reportes"===a&&this.fetchReportes()},logout(){localStorage.removeItem("agente"),this.$router.push("/login")},async registrarInfraccion(){try{const a=await n.A.post("https://backendmiinfraccion-production.up.railway.app/api/infracciones/registrar",{agente_id:this.agenteId,ciudadano_id:this.infraccion.ciudadano_id||null,vehiculo_id:this.infraccion.vehiculo_id||null,lugar:this.infraccion.lugar,fecha:this.infraccion.fecha,hora:this.infraccion.hora,descripcion:this.infraccion.descripcion,placas:this.infraccion.placas,color:this.infraccion.color,estado:this.infraccion.estado,marca:this.infraccion.marca});201===a.status&&(alert("Infracción registrada con éxito"),this.infraccion={},this.fetchInfracciones())}catch(a){console.error("Error al registrar la infracción:",a.response?.data||a.message),alert(`Error al registrar la infracción: ${a.response?.data?.mensaje||"Inténtelo nuevamente."}`),a.response?.data?.error&&console.error("Detalles adicionales del error:",a.response.data.error)}},async eliminarInfraccion(a){console.log(`ID de infracción a eliminar: ${a}`);try{const e=await n.A.delete(`https://backendmiinfraccion-production.up.railway.app/api/infracciones/eliminar/${a}`);200===e.status&&(alert("Infracción eliminada con éxito"),this.fetchInfracciones())}catch(e){console.error("Error al eliminar la infracción:",e.response?e.response.data:e.message),alert(`Error al eliminar la infracción: ${e.response?.data?.mensaje||e.message||"Error desconocido"}`)}},async fetchInfracciones(){try{const a=await n.A.get(`https://backendmiinfraccion-production.up.railway.app/api/infracciones/agente/${this.agenteId}`);200===a.status&&(this.infracciones=a.data)}catch(a){console.error("Error al obtener infracciones:",a),alert("Error al cargar las infracciones.")}},async notificarCiudadano(a){try{const e=await n.A.post("https://backendmiinfraccion-production.up.railway.app/api/notificaciones/enviar",{placas:a.placas,agente_id:this.agenteId,lugar:a.lugar,descripcion:a.descripcion,fecha:a.fecha});200===e.status&&alert("Notificación enviada al ciudadano.")}catch(e){console.error("Error al notificar al ciudadano:",e),alert("Error al enviar la notificación.")}},formatFecha(a){const e=new Date(a);return e.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})},async cambiarEstado(a,e){try{const i=await n.A.put(`https://backendmiinfraccion-production.up.railway.app/api/reportes/${a}/estado`,{estado:e});if(200===i.status){alert(`Reporte actualizado a: ${e}`);const i=this.reportes.find((e=>e.id===a));i&&(i.estado=e)}}catch(i){console.error("Error al actualizar el estado del reporte:",i),alert("Error al actualizar el reporte. Intenta nuevamente.")}},async fetchReportes(){try{const a=await n.A.get("https://backendmiinfraccion-production.up.railway.app/api/reportes");console.log("Datos recibidos:",a.data),this.reportes=a.data}catch(a){console.error("Error al cargar reportes:",a),alert("Error al cargar los reportes.")}}}},c=o,s=i(1656),l=(0,s.A)(c,t,r,!1,null,"cc31e7aa",null),d=l.exports}}]);
//# sourceMappingURL=about.92c86e84.js.map